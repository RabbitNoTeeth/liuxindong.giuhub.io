[TOC]



# 方式1：修改开机启动文件

通过修改开机启动文件 `/etc/rc.local`（或者`/etc/rc.d/rc.local`，两者实际为同一个文件，前者是后者的软链接）。



```
# 1.编辑rc.local文件
[root@localhost ~]# vi /etc/rc.local
 
# 2.修改rc.local文件，在 exit 0 前面加入要执行的命令（此处以gitlab启动命令为例）。保存并退出。
gitlab-ctl start
 
# 3.最后修改rc.local文件的执行权限
[root@localhost ~]# chmod +x /etc/rc.local
```



# 方式2：编写shell脚本放入启动目录中

将写好的脚本（.sh文件）放到目录 /etc/profile.d/ 下，系统启动后就会自动执行该目录下的所有shell脚本。



# 方式3：通过chkconfig命令设置

```
# 1.将(脚本)启动文件移动到 /etc/init.d/ 或者 /etc/rc.d/init.d/ 目录下（前者是后者的软连接）。
mv ./test.sh /etc/rc.d/init.d
 
# 2.启动文件前面务必添加如下三行代码，否侧会提示chkconfig不支持。
#!/bin/sh             告诉系统使用的shell,所以的shell脚本都是这样
#chkconfig: 35 20 80        分别代表运行级别，启动优先权，关闭优先权，此行代码必须
#description: http server     自己随便发挥！！！，此行代码必须

# 此处以gitlab启动命令为例
gitlab-ctl start
 
# 3.增加脚本的可执行权限
chmod +x /etc/rc.d/init.d/test.sh
 
# 4.添加脚本到开机自动启动项目中。添加到chkconfig，开机自启动。
[root@localhost ~]# cd /etc/rc.d/init.d
[root@localhost ~]# chkconfig --add test.sh
[root@localhost ~]# chkconfig test.sh on
 
# 5.关闭开机启动 
[root@localhost ~]# chkconfig test.sh off
 
# 6.从chkconfig管理中删除test.sh
[root@localhost ~]# chkconfig --del test.sh
 
# 7.查看chkconfig管理
[root@localhost ~]# chkconfig --list test.sh
```



# 方式4：自定义服务文件，添加到系统服务，通过Systemctl管理

1. 编写服务文件：gitlab.service

   ```
   # gitlab.service服务文件
   [Unit]
   Description=gitlab                                        # 描述服务
   After=network.target remote-fs.target nss-lookup.target   # 描述服务类别
    
   [Service]
   Type=forking                                              # 后台运行
   ExecStart=gitlab-ctl start                                # 启动命令
   ExecReload=gitlab-ctl restart                             # 重启命令
   ExecStop=gitlab-ctl stop                                  # 停止命令
    
   [Install]
   WantedBy=multi-user.target 
   ```

   

2. 将 `gitlab.service` 文件保存至 `/usr/lib/systemd/system` 目录下，修改权限为 754

   ```
   mv ./gitlab.service /usr/lib/systemd/system
   chmod 745 /usr/lib/systemd/system/gitlab.service
   ```

   

3. 设置开机自启动（如果执行启动命令报错，则执行：systemctl daemon-reload）

   ```
   设置开机自启动
   [root@localhost ~]# systemctl enable gitlab.service
    
   停止开机自启动
   [root@localhost ~]# systemctl disable gitlab.service
    
   验证一下是否为开机启动
   [root@localhost ~]# systemctl is-enabled gitlab
   ```



4. 启动命令

   ```
   启动gitlab服务
   [root@localhost ~]# systemctl start gitlab.service
    
   停止gitlab服务
   [root@localhost ~]# systemctl stop gitlab.service
    
   重启gitlab服务
   [root@localhost ~]# systemctl restart gitlab.service
    
   查看gitlab服务当前状态
   [root@localhost ~]# systemctl status gitlab.service
   ```

   
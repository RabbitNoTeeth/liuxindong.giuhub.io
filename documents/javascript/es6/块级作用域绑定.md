[TOC]



# 1 var声明及变量提升机制

在函数作用域或者全局作用域中通过关键字var声明的变量，无论实际上是在哪里声明的，都会被当成当前作用域顶部声明的变量，这也就是常说的提升机制。

下面来看一个代码示例：

```
function getValue(condition) {
    if(condition){
        var value = 'yes';
        return value;
    }else{
        value = 'no';
        return value;
    }
}

console.log(getValue(true));
console.log(getValue(false));

输出结果：
yes
no
```

可以看到，本来变量value实在if语句块中声明的，但是在else中却可以正常获取到value变量的值并且修改，这就是所谓的提升机制。

由于提升机制的存在，很多时候我们在编写代码时可能不知道在当前作用域下是否存在某个变量，这就可能由于我们错误的判断而导致潜在的bug。



# 2 块级声明

块级声明用于声明在指定块的作用域之外无法访问的变量，块级作用域存在于：函数内部、 块中（字符 ‘{’ 和 ‘}’ 之间的区域）。



## 2.1 let

let声明的用法与var相同，但是let声明不会被提升。

使用let声明重写上面的代码示例：

```
function getValue(condition) {
    if(condition){
        let value = 'yes';
        return value;
    }else{
        return value;
    }
}

console.log(getValue(true));
console.log(getValue(false));

输出结果：
yes
ReferenceError: value is not defined
```

可以看到，由于块级作用域的存在，else中是访问不到变量value的。



**注意：**

在使用let变量时，要注意重复声明的问题，下面来看两个代码示例的对比：
代码1：

```
function say() {
    var name = 'liuxindong';
    let name = 'don9';
    return name;
}

console.log(say());
输出结果：
SyntaxError: Identifier 'name' has already been declared

代码2：
var name = 'liuxindong';

function say() {
    let name = 'don9';
    return name;
}

console.log(say());
输出结果：
don9
```



## 2.2 const

const声明也是块级声明，但是const声明的是常量，声明的常量必须提供初始化，并且初始化后值不可更改。



# 3 全局块作用域绑定

let、const与var的另一个很关键的区别是他们在全局作用域中的行为。

首先，来看一个var的代码示例：

```
>window.name = “liuxindong”
“liuxindong”
>window.name
“liuxindong”
>var name = “liuxindong222”
>name
“liuxindong222”
>window.name
“liuxindong222”
>window.name === name
true
```

上面的代码是在浏览器的console控制台测试的，可以看到，var变量声明的name属性覆盖了一开始在window上直接声明的name属性。 也就是说，在全局作用域的处理上，var声明会完全覆盖掉相同的变量。



这次来看下let声明的在浏览器的表现：

```
>window.name = “liuxindong”
“liuxindong”
>window.name
“liuxindong”
>let name = “liuxindong222”
>name
“liuxindong222”
>window.name
“liuxindong”
>window.name === name
false
```

很明显，let声明的name属性并没有覆盖掉window上的name属性，const声明的行为同let一样，在此处就不再放多余的代码了。 通过上面的对比，在处理全局变量与全局对象属性时，let和const声明是更加安全的，因为它们不会存在覆盖行为。



**一般来讲，使用块级绑定的最佳实践是：默认使用const，只在确实需要改变变量的值时使用let。**
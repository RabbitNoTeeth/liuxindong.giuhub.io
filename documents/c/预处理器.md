[TOC]



# 1 文件包含（#include）

**格式：**

```
#include "文件名"
#include <文件名>
```

所有 #include 所在行都将被替换为由文件名指定的文件的内容。

如果文件名用引号引起来，则在源文件所在的位置查找该文件；如果该位置没有找到文件，或者文件名用<>括起来，则根据相应的规则查找该文件。



# 2 宏替换（#define）

**格式：**

```
#define 名字 替换文本
```



替换文本不一定是侠义上的“字符文本”，可以是任意的，如：

```
#define TRUE "true"       	// ①

#define TRUE 1				// ②

#define forever for(;;)		// ③

#define max(A, B) ((A) > (B) ? (A) : (B))	// ④
```



宏定义可以携带参数，如上述示例中④，看起来很像函数调用，但是与函数调用不同的是，宏调用直接将替换文本插入到代码中，例如：

```
x = max(p+q, r+s);
将被替换为下列形式：
x = ((p+q) > (r+s) ? (p+q) : (r+s));
```



可以通过 #undef 指令取消名字的宏定义，这样做一般用于保证后续的调用是函数调用，而不是宏调用。



如果在替换文本中，参数名以#作为前缀则结果将被扩展为由实际参数替换该参数的带引号的字符串，例如：

```
#define dprint(expr) printf(#expr " = %g\n", expr)

进行宏调用
dprint(x/y);

代码将被替换为
printf("x/y" " = %g\n", x/y);
即
printf("x/y = %g\n", x/y);
```



# 条件包含（#if）

判断名字是否被定义：

```
#if !defined(HDR)  // 等价于 #ifndef HDR
#define HDR xxx
#endif
```



判断名字是否为特定值：

```
#if SYSTEM == A
	#define HDR "a.h"
#elseif SYSTEM == B
	#define HDR "b.h"
#elseif SYSTEM == C
	#define HDR "c.h"
#else SYSTEM == D
	#define HDR "d.h"
#include HDR    
```

